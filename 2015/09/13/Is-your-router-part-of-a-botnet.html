<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Is your router part of a botnet?</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="//dosattack.net/themes/Casper/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//dosattack.net/themes/Casper/assets/css/screen.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />

    <link rel="canonical" href="http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html" />
    
    <meta property="og:site_name" content="Adam Syed" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Is your router part of a botnet?" />
    <meta property="og:description" content="Recently the amount of compromised routers have been increasing tremendously due to &quot;hacking group&quot; called &quot;LizardSquad&quot; notoriously known for their large DDoS attacks against PSN (Playstation Network) and Xbox Live. Their bot and C&amp;amp;C was &quot;leaked&quot; to Gthub..." />
    <meta property="og:url" content="http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html" />
    <meta property="article:published_time" content="2015-09-13T07:00:00.000Z" />
    <meta property="article:modified_time" content="2015-09-13T22:58:42.332Z" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Is your router part of a botnet?" />
    <meta name="twitter:description" content="Recently the amount of compromised routers have been increasing tremendously due to &quot;hacking group&quot; called &quot;LizardSquad&quot; notoriously known for their large DDoS attacks against PSN (Playstation Network) and Xbox Live. Their bot and C&amp;amp;C was &quot;leaked&quot; to Gthub..." />
    <meta name="twitter:url" content="http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Adam Syed",
    "author": {
        "@type": "Person",
        "name": "Adam Syed",
        "image": "https://avatars.githubusercontent.com/u/3879307?v=3",
        "url": "undefined/author/undefined",
        "sameAs": "www.cdnsolution.net"
    },
    "headline": "Is your router part of a botnet?",
    "url": "http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html",
    "datePublished": "2015-09-13T07:00:00.000Z",
    "dateModified": "2015-09-13T22:58:42.332Z",
    "description": "Recently the amount of compromised routers have been increasing tremendously due to &quot;hacking group&quot; called &quot;LizardSquad&quot; notoriously known for their large DDoS attacks against PSN (Playstation Network) and Xbox Live. Their bot and C&amp;amp;C was &quot;leaked&quot; to Gthub..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Adam Syed" href="http://dosattack.net/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
</head>
<body class="post-template">

    


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="back-button icon-arrow-left" href="http://dosattack.net">Home</a>
        <!-- <a class="subscribe-button icon-feed" href="http://dosattack.net/rss/">Subscribe</a> -->
    </nav>
</header>

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Is your router part of a botnet?</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2015-09-13">13 September 2015</time> 
            </section>
        </header>

        <section class="post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recently the amount of compromised routers have been increasing tremendously due to "hacking group" called "LizardSquad" notoriously known for their large DDoS attacks against PSN (Playstation Network) and Xbox Live. Their bot and C&amp;C was "leaked" to Gthub for all to see and use (<a href="https://github.com/gh0std4ncer/lizkebab" class="bare">https://github.com/gh0std4ncer/lizkebab</a>). In this article we will be talking about what to do when your router is compromised but first, let&#8217;s go over the basics -</p>
</div>
<div class="paragraph">
<p>The bot contained the following commands -</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PING
GETLOCALIP
SCANNER ON/OFF
HOLD
JUNK
UDPTCP
KILLATTK
LOLNOGTFO</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s briefly go over what each of these commands do.</p>
</div>
<div class="paragraph">
<p>"PING" - As you would expect, this command responds with "PONG!" to the C&amp;C.</p>
</div>
<div class="paragraph">
<p>"GETLOCALIP" - This command responds to the C&amp;C with the router&#8217;s local IP.</p>
</div>
<div class="paragraph">
<p>"SCANNER ON/OFF" - This activates the telnet scanner/bruteforcer (a/k/a "StartTheLelz"). What does "StartTheLelz" do? It essentially brute forces/scans random IPs for the usernames and passwords that were prviously assigned in the variables "usernames" and "passwords.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C" data-lang="C">char *usernames[] = {"root\0", "\0", "admin\0", "user\0", "login\0", "guest\0"};
char *passwords[] = {"root\0", "\0", "toor\0", "admin\0", "user\0", "guest\0", "login\0", "changeme\0", "1234\0", "12345\0", "123456\0", "default\0", "pass\0", "password\0"};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once into a system it executes the command "sh" followed by</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/bin/busybox;echo -e '\\147\\141\\171\\146\\147\\164'</pre>
</div>
</div>
<div class="paragraph">
<p>What does this do? Basically what this command does is respond with a string only on busybox machines, this prevents it from getting any machines that don&#8217;t have busybox on it.</p>
</div>
<div class="paragraph">
<p>Output on a busybox machine -</p>
</div>
<div class="literalblock">
<div class="content">
<pre> root@b33f1b831e1d:~# echo -e '\\147\\141\\171\\146\\147\\164'
gayfgt
root@b33f1b831e1d:~#</pre>
</div>
</div>
<div class="paragraph">
<p>Output on a non-busybox machine -</p>
</div>
<div class="literalblock">
<div class="content">
<pre> root@b33f1b831e1c:~# echo -e '\\147\\141\\171\\146\\147\\164'
\147\141\171\146\147\164
root@b33f1b831e1c:~#</pre>
</div>
</div>
<div class="paragraph">
<p>What is this random string? This is a Octal string with backslash escapes. The argument "-e" in the echo command (according to the man file for echo) enables the following -</p>
</div>
<div class="literalblock">
<div class="content">
<pre> -e
enable interpretation of backslash escapes</pre>
</div>
</div>
<div class="paragraph">
<p>You can play around with Octal strings here - <a href="https://encoder.internetwache.org/" class="bare">https://encoder.internetwache.org/</a></p>
</div>
<div class="paragraph">
<p>If the bot responds with the correct string "gayfgt" then it reports it to the C&amp;C and the C&amp;C saves it to output.txt in the format of "IP:username:password)</p>
</div>
<div class="paragraph">
<p>"HOLD" - This activates the "HOLD" DoS attack</p>
</div>
<div class="paragraph">
<p>"JUNK" - This activates the "JUNK" DoS attack</p>
</div>
<div class="paragraph">
<p>"UDP" - This activates a UDP DoS attack</p>
</div>
<div class="paragraph">
<p>"TCP" - This activates a TCP DoS attack method that allows you to set numerous options such as the destination port (or randomize it), a netmask to spoof it by (or not spoof it), the flags of the TCP packet (can be used to bypass some attack mitigation systems), the packet size (can be used to bypass some mitigation systems), and a poll interval for the attack.
What do I mean by a poll interval? Essentially the attack is sent every X seconds in intervals for the max time of the attack, this uses less resources on the bot&#8217;s side and would still have a bad outcome on the attacked servers end, an exampe would be bursts of the attack every 10 seconds for 300 seconds.</p>
</div>
<div class="paragraph">
<p>"KILLATTK" - Kills any ongoing attacks</p>
</div>
<div class="paragraph">
<p>"LOLNOGTFO" - Kills the bot.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_how_do_i_protect_my_router_from_this">How do I protect my router from this!?</h4>
<div class="paragraph">
<p>It&#8217;s quite simple, change your router&#8217;s credentials away from the default credentials and close off port 23 from public access. It takes like 5 minutes and saves you a lot of trouble in the future!</p>
</div>
</div>
<div class="sect3">
<h4 id="_what_if_they_re_already_in_my_router">What if they&#8217;re already in my router!?</h4>
<div class="paragraph">
<p>If they&#8217;re already in your router then you can attempt to do numerous things to get rid of them, one of which is find the process and kill it. I&#8217;ve written this small script to kill running programs that aren&#8217;t necessary by the system itself (not extremely accurate nor the best way of going about it) -</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C" data-lang="C">#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;dirent.h&gt;
#include &lt;unistd.h&gt;
#include &lt;signal.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;

pid_t proc_find(const char* name)
{
    DIR* dir;
    struct dirent* ent;
    char buf[512];
    char buff[512];

    long  pid;
    char pname[100] = {0,};
    char state;
    FILE *fp=NULL;
    FILE *cmdline=NULL;
    if (!(dir = opendir("/proc"))) {
        perror("can't open /proc");
        return -1;
    }

    while((ent = readdir(dir)) != NULL) {
        long lpid = atol(ent-&gt;d_name);
        if(lpid &lt; 0)
            continue;
        snprintf(buf, sizeof(buf), "/proc/%ld/stat", lpid);
        fp = fopen(buf, "r");

        if (fp) {
	    printf("%ld:%s\n", lpid, pname);
            if ( (fscanf(fp, "%ld (%[^)]) %c", &amp;pid, pname, &amp;state)) != 3 ){
                printf("fscanf failed \n");
                fclose(fp);
                closedir(dir);
                return -1;
            }
            if (!strcmp(pname, name)) {
		printf("Whitelisted!\n");
		continue;
            } else {
                long size ;
                snprintf(buff, sizeof(buff), "/proc/%ld/cmdline", lpid);
		cmdline = fopen(buff, "r+");
		int count = 0;
		while(fgetc(cmdline) != EOF)
		{
			count++;
		}
                if (count &gt; 10) { kill(pid, SIGTERM); }
                printf("%ld:%s:%lld\n", lpid, pname, count);
            }
            fclose(cmdline);
            fclose(fp);
        }
    }


closedir(dir);
return -1;
}


int main(int argc, char* argv[])
{
    int i;
    if (argc == 1) {
        printf("usage: %s &lt;whitelisted process&gt;\n", argv[0]);
        return 1;
    }

    for( i = 1; i &lt; argc; ++i) {
        pid_t pid = proc_find(argv[i]);

    }

    return 0;
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_compiling_and_running">Compiling and running</h6>
<div class="paragraph">
<p>Compile - <code>gcc main.c</code></p>
</div>
<div class="paragraph">
<p>Running - <code>./a.out &lt; whitelisted process &gt;</code></p>
</div>
<div class="paragraph">
<p>I&#8217;ll be adding more to this article as I see fit and when I get less lazy.</p>
</div>
</div>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="" style="background-image: url(https://avatars.githubusercontent.com/u/3879307?v=3)"><span class="hidden">Adam Syed's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="">Adam Syed</a></h4>

                    <p>Read <a href="">more posts</a> by this author.</p>
                <div class="author-meta">
                    <span class="author-location icon-location">Pennsylvania</span>
                    <span class="author-link icon-link"><a href="www.cdnsolution.net">www.cdnsolution.net</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=Is%20your%20router%20part%20of%20a%20botnet%3F&amp;url=http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://dosattack.net/2015/09/13/Is-your-router-part-of-a-botnet.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


    </article>

</main>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="http://dosattack.net">Adam Syed</a> &copy; 2015</section>
        <section class="poweredby">Proudly published with <a href="http://hubpress.io">HubPress</a></section>
    </footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

    <script type="text/javascript" src="//dosattack.net/themes/Casper/assets/js/jquery.fitvids.js?v=1.0.0"></script>
    <script type="text/javascript" src="//dosattack.net/themes/Casper/assets/js/index.js?v=1.0.0"></script>

</body>
</html>
